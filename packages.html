<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Investment Packages | Trade World</title>
    <link rel="stylesheet" href="./assets/css/style.css">
</head>
<body>
    <!-- Header and Sidebar same as before -->

    <main class="main-content" id="mainContent">
        <h1 class="page-title">Investment Packages</h1>
        
        <div class="packages-grid">
            <!-- Package 1 -->
            <div class="package-card">
                <h3 class="package-name">Starter Package</h3>
                <div class="package-price">$10</div>
                <div class="package-return">Returns $20</div>
                <ul class="package-features">
                    <li><i class="fas fa-check-circle"></i> 100% Return on Investment</li>
                    <li><i class="fas fa-check-circle"></i> 10% to your sponsor</li>
                    <li><i class="fas fa-check-circle"></i> 2% to upper levels</li>
                </ul>
                <button class="btn btn-primary" data-package="10" id="package10">Buy Now</button>
            </div>
            
            <!-- Other packages same structure -->
        </div>

        <!-- Package Purchase Modal -->
        <div class="modal" id="packageModal">
            <div class="modal-content">
                <button class="modal-close" id="closePackageModal">&times;</button>
                <h2 class="modal-title">Confirm Package Purchase</h2>
                
                <div class="form-group">
                    <p>You are about to purchase the <span id="packageName">Starter</span> package for $<span id="packagePrice">10</span></p>
                    <p>Your current balance: $<span id="modalBalance">0.00</span></p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Enter your password to confirm</label>
                    <input type="password" class="form-control" id="confirmPassword">
                </div>
                
                <button class="btn btn-primary" id="confirmPurchase">Confirm Purchase</button>
            </div>
        </div>
    </main>

    <!-- Same scripts as before plus package handling -->
    <script>
        // Package purchase handling
        document.querySelectorAll('[data-package]').forEach(btn => {
            btn.addEventListener('click', function() {
                if (!currentUser) {
                    window.location.href = 'login.html';
                    return;
                }
                
                const packageAmount = this.getAttribute('data-package');
                const packageName = this.closest('.package-card').querySelector('.package-name').textContent;
                
                // Show confirmation modal
                document.getElementById('packageName').textContent = packageName;
                document.getElementById('packagePrice').textContent = packageAmount;
                document.getElementById('modalBalance').textContent = userData.balance || '0.00';
                document.getElementById('packageModal').classList.add('open');
                
                // Store package amount in modal
                document.getElementById('confirmPurchase').setAttribute('data-package', packageAmount);
            });
        });

        // Confirm purchase
        document.getElementById('confirmPurchase').addEventListener('click', function() {
            const packageAmount = parseFloat(this.getAttribute('data-package'));
            const password = document.getElementById('confirmPassword').value;
            
            if (!password) {
                showToast('Please enter your password', 'error');
                return;
            }
            
            // Reauthenticate user
            const credential = firebase.auth.EmailAuthProvider.credential(
                currentUser.email, 
                password
            );
            
            currentUser.reauthenticateWithCredential(credential)
                .then(() => {
                    // Proceed with package purchase
                    purchasePackage(packageAmount);
                    document.getElementById('packageModal').classList.remove('open');
                })
                .catch(error => {
                    showToast('Authentication failed: ' + error.message, 'error');
                });
        });
    </script>
</body>
</html>
